
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Pythonic programming &#8212; docs  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about/" />
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
  
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../blog/atom.xml" title="ericrmc">
  
  
  <link href="True" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pythonic-programming">
<h1>Pythonic programming<a class="headerlink" href="#pythonic-programming" title="Permalink to this headline">¶</a></h1>
<p>A YouTube talk on the benefits of functional “Pythonic” programming over mere PEP8 adherance
contained many great live examples.
The gist was that while some code may look correct and comply with the style guide,
it may not be the <em>best</em> way to actually go about something.
It was presented at PyCon 2015, here’s the link:</p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=wf-BqAjZb8M">Raymond Hettinger - Beyond PEP 8 – Best practices for beautiful intelligible code</a></p>
<p>One case in point was a function that looked like it had been ported over from Java.
Sure, it may have the correct indenting and formatting that PEP8 demands, but it wasn’t
incorporating some of the fantastic efficiencies that Python has built in, right out of the box.
I’ve noted down some of the examples but for further explanation please see the video.</p>
<ul class="simple">
<li>Custom exceptions</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClassException</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">failure</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">MyClassException</span><span class="p">(</span><span class="s1">&#39;error 1&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Named tuples for better item management:</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="n">Colour</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Colour&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;hue&#39;</span><span class="p">,</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Colour</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">saturation</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Use more descriptive variable and function names, and include keywords in arguments to assist readability, e.g. <code class="docutils literal notranslate"><span class="pre">connect_to_proxy(server=127,</span> <span class="pre">port=8080)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">range()</span></code> has been improved in Python 3, so if still on Python 2 use <code class="docutils literal notranslate"><span class="pre">xrange()</span></code> instead.</li>
<li>Instead of <code class="docutils literal notranslate"><span class="pre">mylist[::-1]</span></code>, use <code class="docutils literal notranslate"><span class="pre">reversed(mylist)</span></code> or <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">item</span> <span class="pre">in</span> <span class="pre">sorted(mylist,</span> <span class="pre">reverse=True)</span></code></li>
<li>Lists can also be sorted by an attribute, like the item length: <code class="docutils literal notranslate"><span class="pre">sorted(mylist,</span> <span class="pre">key=len)</span></code></li>
<li>Use enumerate(mylist) instead of indices as the index is easier to use:</li>
</ul>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mylist</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">mylist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">zip()</span></code> doesnt scale that well, but <code class="docutils literal notranslate"><span class="pre">izip()</span></code> works more efficiently in Python 3.</li>
<li>A sentinel value is the last chunk of data we read in, and may sometimes just be <code class="docutils literal notranslate"><span class="pre">\r</span></code>. Instead of using a <code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">True</span></code> loop, we can take advantage of new functionality. The <code class="docutils literal notranslate"><span class="pre">iter()</span></code> function arguments are a loop and the sentinel. In this case, the loop requires an argument itself, which we can’t fit into <code class="docutils literal notranslate"><span class="pre">iter()</span></code> normally. So we use <code class="docutils literal notranslate"><span class="pre">functools.partial()</span></code>, which breaks it up for us. We must still be careful with selection of the sentinel though, in case we actually wanted to send a carriage return or empty item.</li>
</ul>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>We can use <code class="docutils literal notranslate"><span class="pre">for</span></code> and <code class="docutils literal notranslate"><span class="pre">else</span></code> for breaking out of code blocks. Here, <code class="docutils literal notranslate"><span class="pre">else</span></code> means “no break”.</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">i</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>You can make a dictionary using two lists: <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">dict(izip(lista,listb))</span></code></li>
<li>To count repeats of items in a dictionary, there is a new <code class="docutils literal notranslate"><span class="pre">defaultdic</span></code> method, however it may have to be converted back to a dictionary when done counting. <code class="docutils literal notranslate"><span class="pre">collections.counter()</span></code> is another way of doing this, too.</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Older method</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="n">d</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># More modern method</span>
<span class="c1"># Here, int can be called with no arguments, so it populates with 0s</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="n">d</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>A <code class="docutils literal notranslate"><span class="pre">defaultdic</span></code> can also be used to group items in a list based on a characteristic, such as string length, and enter in default values so they can be grouped:</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">key,</span> <span class="pre">value</span> <span class="pre">=</span> <span class="pre">{</span> <span class="pre">}.popitem()</span></code> is atomic and thread safe.</li>
<li><code class="docutils literal notranslate"><span class="pre">ChainMap(bestdicvars,</span> <span class="pre">seconddicvars,</span> <span class="pre">remainderdicvars)</span></code> does a ranked map in that order.</li>
<li>Use simultaneous state updates for variables, ie. have big equations with intermediate variables in one command:</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
                <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
                <span class="n">influence</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">influence</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">,</span><span class="n">dx</span> <span class="p">,</span><span class="n">dy</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>It’s faster to concatenate lists of strings with <code class="docutils literal notranslate"><span class="pre">.join()</span></code> than <code class="docutils literal notranslate"><span class="pre">+=</span></code>.</li>
<li>We actually don’t need to use square brackets for generator expressions: <code class="docutils literal notranslate"><span class="pre">sum(i**2</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">xrange(10))</span></code></li>
<li>Removing a file if it exists is lengthy, so use ignore instead:</li>
</ul>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ignored</span><span class="p">(</span><span class="ne">OSError</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;file.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>Avoid the use of <code class="docutils literal notranslate"><span class="pre">try</span></code>, <code class="docutils literal notranslate"><span class="pre">finally</span></code> and <code class="docutils literal notranslate"><span class="pre">lock.release</span></code>. Instead, use <code class="docutils literal notranslate"><span class="pre">with</span></code>:</li>
</ul>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
<span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">deque()</span></code> is a new method used for updating variables in sequences:</li>
</ul>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Old method</span>
<span class="k">del</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">names</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">)</span>

<span class="c1"># Modern data structure</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
<span class="k">del</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
<span class="n">names</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="s1">&#39;newname&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  
  <a href="../20180419_sampling/">
    <i class="fa fa-arrow-circle-left"></i>
    Sampling strategies
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  
  <a href="../20180422_distributed-query/">
    Distributed query processing
    <i class="fa fa-arrow-circle-right"></i>
  </a>
  </span>
  
</div>

  
  
  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../">docs</a></h1>









  
  
  <h2>
  
  <i class="fa fa-calendar"></i>
    20 April 2018
  
  </h2>

  <ul>
    

  
  <li id="author"><span><i class="fa-fw fa fa-user"></i>
    
      
      <a href="../blog/author/ericrmc/">ericrmc</a>
      
    </li>
  

  

  

  

  
  <li id="tags"><span><i class="fa-fw fa fa-tag"></i>
    
      
      <a href="../blog/tag/python/">Python</a>
      
    </li>
  
  
  </ul>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/">About this site</a></li>
<li class="toctree-l1"><a class="reference internal" href="../showcase/">Showcase</a></li>
</ul>


  <h3><a href="../blog/">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../20180424_bash/">30 July - Bash shell notes</a></li>
    
      <li><a href="../20180423_geopandas/">23 April - GeoPandas for geospatial data in Python</a></li>
    
      <li><a href="../20180422_distributed-query/">22 April - Distributed query processing</a></li>
    
      <li><a href="../20180419_sampling/">19 April - Sampling strategies</a></li>
    
      <li><a href="../20180419_hadoop/">19 April - Getting started with Hadoop and Hive</a></li>
    
  </ul>

  <h3><a href="../blog/tag/">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/arcgis/">ArcGIS</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/bash/">Bash</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/hadoop/">Hadoop</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/hive/">Hive</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../blog/tag/python/">Python</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/r/">R</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/sql/">SQL</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/geospatial/">geospatial</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/meta/">meta</a></li>
      
    
  </ul>

  <h3><a href="../blog/archive/">Archives</a></h3>
  <ul>
  
    
    <li><a href="../blog/2018/">2018 (11)</a></li>
    
  
  </ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, ericrmc.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/20180420_pythonic.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>